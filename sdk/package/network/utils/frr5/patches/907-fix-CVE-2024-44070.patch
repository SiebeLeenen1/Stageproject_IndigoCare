--- a/bgpd/bgp_attr.c
+++ b/bgpd/bgp_attr.c
@@ -1965,6 +1965,16 @@ static int bgp_attr_encap(uint8_t type,
 			return -1;
 		}
 
+		if (STREAM_READABLE(BGP_INPUT(peer)) < sublength) {
+			zlog_info(
+				"Tunnel Encap attribute sub-tlv length %d exceeds remaining stream length %zu",
+				sublength, STREAM_READABLE(BGP_INPUT(peer)));
+			bgp_notify_send_with_data(
+				peer, BGP_NOTIFY_UPDATE_ERR,
+				BGP_NOTIFY_UPDATE_OPT_ATTR_ERR, startp, total);
+			return -1;
+		}
+
 		/* alloc and copy sub-tlv */
 		/* TBD make sure these are freed when attributes are released */
 		tlv = XCALLOC(MTYPE_ENCAP_TLV,
